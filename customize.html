<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-TJDWMQZV');</script>
  <!-- End Google Tag Manager -->

  <meta charset="UTF-8" />
  <title>Customize Your Trek - Smart Trails</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles/main.css" />
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  
  <style>
    /* CSS Variables for consistent theming - Green color scheme matching Smart Trails brand */
    :root {
      --primary: #2D5016;        /* Original Smart Trails green */
      --primary-light: #4A7C28;  /* Lighter green */
      --primary-lighter: #6B9A3C;
      --accent: #F39C12;
      --orange: #F39C12;
      --text-dark: #2C3E50;
      --text-light: #5D6D7E;
      --bg-light: #F8F9FA;
      --white: #FFFFFF;
      --shadow: rgba(0, 0, 0, 0.1);
      --success: #27AE60;
      --warning: #E74C3C;
      --info: #3498DB;
      
      /* Quiz specific */
      --text-primary: #222222;
      --text-secondary: #717171;
      --border: #DDDDDD;
      --background-secondary: #F7F7F7;
      --radius: 12px;
      --radius-sm: 8px;
      --shadow-sm: rgba(0, 0, 0, 0.04) 0px 6px 16px;
      --shadow-md: rgba(0, 0, 0, 0.12) 0px 6px 16px;
      --shadow-lg: rgba(0, 0, 0, 0.12) 0px 6px 20px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: var(--bg-light);
    }

    /* Enhanced Hero Section */
    .hero-enhanced {
      position: relative;
      height: 50vh;
      min-height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: white;
      overflow: hidden;
    }

    .hero-bg {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
    }

    .hero-bg::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, 
        rgba(0,0,0,0.2) 0%, 
        rgba(0,0,0,0.4) 50%, 
        rgba(0,0,0,0.6) 100%);
    }

    .hero-content-enhanced {
      position: relative;
      z-index: 1;
      max-width: 800px;
      padding: 0 20px;
    }

    .hero-content-enhanced h1 {
      font-size: 3em;
      margin-bottom: 0;
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    /* Main content area */
    .main-content-area {
      max-width: 640px;
      margin: -60px auto 0;
      position: relative;
      z-index: 10;
      padding: 0 20px 40px;
    }

    /* Quiz Container Styles */
    .quiz-container {
      background: var(--white);
      border-radius: var(--radius);
      box-shadow: var(--shadow-lg);
      width: 100%;
      overflow: hidden;
      border: 1px solid var(--border);
      opacity: 1;
      transform: translateY(0);
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .quiz-container.fade-out {
      opacity: 0;
      transform: translateY(-20px);
    }

    /* Progress Bar */
    .progress-container {
      height: 4px;
      background: #E8F5E9;
      position: relative;
      overflow: hidden;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 50%, var(--primary-lighter) 100%);
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 3px;
      position: relative;
      box-shadow: 0 2px 8px rgba(45, 80, 22, 0.3);
    }

    .progress-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.3),
        transparent
      );
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    .progress-bar::before {
      content: '';
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      background: radial-gradient(circle, var(--primary-lighter), transparent);
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { 
        opacity: 0.6;
        transform: translateY(-50%) scale(0.8);
      }
      50% { 
        opacity: 1;
        transform: translateY(-50%) scale(1.2);
      }
    }

    /* Quiz Content - COMPACT */
    .quiz-content {
      padding: 24px;
    }

    .quiz-header {
      margin-bottom: 20px;
      position: relative;
    }

    .quiz-header::before {
      content: '';
      position: absolute;
      top: -10px;
      right: -10px;
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, rgba(74, 124, 40, 0.1), rgba(243, 156, 18, 0.1));
      border-radius: 50%;
      filter: blur(20px);
    }

    .step-indicator {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 8px;
      font-weight: 400;
    }

    .question-title {
      font-size: 22px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.3;
      margin-bottom: 4px;
    }

    .question-subtitle {
      font-size: 14px;
      color: var(--text-secondary);
      font-weight: 400;
    }

    /* Question Slides - COMPACT */
    .questions-wrapper {
      min-height: 200px;
      position: relative;
    }

    .question-slide {
      position: absolute;
      width: 100%;
      opacity: 0;
      visibility: hidden;
      transform: translateX(20px);
      transition: all 0.3s ease;
    }

    .question-slide.active {
      opacity: 1;
      visibility: visible;
      transform: translateX(0);
      position: relative;
    }

    /* Option Buttons - COMPACT */
    .options-grid {
      display: grid;
      gap: 10px;
      margin-top: 20px;
    }

    .option-button {
      padding: 16px 20px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--white);
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: left;
      width: 100%;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .option-button:hover {
      border-color: var(--primary-light);
      box-shadow: var(--shadow-sm);
    }

    .option-button.selected {
      border-color: var(--primary);
      background: #F0F7ED;
      box-shadow: 0 0 0 1px var(--primary);
    }

    .option-icon {
      flex-shrink: 0;
      color: var(--primary-light);
      transition: all 0.2s ease;
    }

    .option-button:hover .option-icon {
      color: var(--primary);
      transform: scale(1.1);
    }

    .option-button.selected .option-icon {
      color: var(--primary);
    }

    /* Icon colors */
    [data-question="trek-type"] .option-icon[data-lucide="clock"] {
      color: var(--orange);
    }
    
    [data-question="trek-type"] .option-icon[data-lucide="tent"] {
      color: var(--primary-light);
    }

    [data-question="location"] .option-icon[data-lucide="globe"] {
      color: #3F51B5;
    }
    
    [data-question="location"] .option-icon[data-lucide="mountain"] {
      color: #4CAF50;
    }
    
    [data-question="location"] .option-icon[data-lucide="mountain-snow"] {
      color: #FF9800;
    }
    
    [data-question="location"] .option-icon[data-lucide="compass"] {
      color: #E91E63;
    }
    
    [data-question="location"] .option-icon[data-lucide="map"] {
      color: #00BCD4;
    }
    
    [data-question="location"] .option-icon[data-lucide="palmtree"] {
      color: #FFC107;
    }

    [data-question="difficulty"] .option-icon[data-lucide="smile"] {
      color: #27AE60;
    }
    
    [data-question="difficulty"] .option-icon[data-lucide="trending-up"] {
      color: var(--orange);
    }
    
    [data-question="difficulty"] .option-icon[data-lucide="zap"] {
      color: #E74C3C;
    }

    [data-question="season"] .option-icon[data-lucide="flower"] {
      color: #E91E63;
    }
    
    [data-question="season"] .option-icon[data-lucide="sun"] {
      color: #FF9800;
    }
    
    [data-question="season"] .option-icon[data-lucide="leaf"] {
      color: #FF6B35;
    }
    
    [data-question="season"] .option-icon[data-lucide="snowflake"] {
      color: #42A5F5;
    }

    [data-question="accommodation"] .option-icon[data-lucide="tent"] {
      color: var(--primary);
    }
    
    [data-question="accommodation"] .option-icon[data-lucide="home"] {
      color: #795548;
    }
    
    [data-question="accommodation"] .option-icon[data-lucide="bed"] {
      color: #9C27B0;
    }
    
    [data-question="accommodation"] .option-icon[data-lucide="layers"] {
      color: #607D8B;
    }

    .option-button:hover .option-icon,
    .option-button.selected .option-icon {
      filter: brightness(1.2);
    }

    .option-content {
      flex: 1;
    }

    .option-title {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 0;
    }

    .option-description {
      font-size: 13px;
      color: var(--text-secondary);
    }

    /* Grid layouts */
    .two-column-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .three-column-grid {
      grid-template-columns: repeat(3, 1fr);
    }

    /* Multi-select - COMPACT */
    .interests-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 20px;
    }

    .interest-button {
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--white);
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      text-align: center;
    }

    .interest-button:hover {
      border-color: var(--primary-light);
    }

    .interest-button.selected {
      border-color: var(--primary);
      background: #F0F7ED;
      box-shadow: 0 0 0 1px var(--primary);
    }

    .interest-icon {
      color: var(--primary-light);
      transition: all 0.2s ease;
    }

    .interest-button:hover .interest-icon {
      color: var(--primary);
      transform: scale(1.1);
    }

    .interest-button.selected .interest-icon {
      color: var(--primary);
    }

    /* Specific interest icon colors */
    .interest-button[data-value="wildlife"] .interest-icon {
      color: #8B6F47;
    }
    
    .interest-button[data-value="photography"] .interest-icon {
      color: #9C27B0;
    }
    
    .interest-button[data-value="culture"] .interest-icon {
      color: #FF6B35;
    }
    
    .interest-button[data-value="solitude"] .interest-icon {
      color: #3F51B5;
    }
    
    .interest-button[data-value="peaks"] .interest-icon {
      color: #607D8B;
    }
    
    .interest-button[data-value="lakes"] .interest-icon {
      color: #00BCD4;
    }
    
    .interest-button[data-value="forests"] .interest-icon {
      color: var(--primary);
    }
    
    .interest-button[data-value="glaciers"] .interest-icon {
      color: #42A5F5;
    }

    .interest-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
    }

    /* Text Input - COMPACT */
    .text-input-wrapper {
      margin-top: 20px;
    }

    .text-input {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-size: 14px;
      font-family: inherit;
      transition: all 0.2s ease;
      resize: vertical;
      min-height: 100px;
    }

    .text-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 1px var(--primary);
    }

    /* Navigation - COMPACT */
    .quiz-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
    }

    .nav-button {
      padding: 12px 20px;
      border-radius: var(--radius-sm);
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      font-family: inherit;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .nav-button.back {
      background: var(--white);
      color: var(--text-primary);
      text-decoration: underline;
      padding-left: 0;
    }

    .nav-button.back:hover {
      color: var(--primary);
    }

    .nav-button.skip {
      background: var(--white);
      color: var(--text-secondary);
      text-decoration: underline;
    }

    .nav-button.skip:hover {
      color: var(--primary);
    }

    .nav-button.next {
      background: var(--primary);
      color: white;
    }

    .nav-button.next:hover {
      background: var(--primary-light);
    }

    .nav-button.next:disabled {
      background: var(--background-secondary);
      color: var(--text-secondary);
      cursor: not-allowed;
    }

    .nav-button.generate {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      padding: 14px 32px;
      font-size: 16px;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(45, 80, 22, 0.3);
      transition: all 0.3s ease;
      border: none;
    }

    .nav-button.generate:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(45, 80, 22, 0.4);
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-lighter) 100%);
    }

    .nav-button.generate:active {
      transform: translateY(0);
    }

    .nav-button.generate [data-lucide="sparkles"] {
      animation: sparkle 2s ease-in-out infinite;
    }

    @keyframes sparkle {
      0%, 100% { 
        transform: scale(1) rotate(0deg); 
        opacity: 1;
      }
      50% { 
        transform: scale(1.2) rotate(180deg); 
        opacity: 0.8;
      }
    }

    /* Loading State - Enhanced */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.98);
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 1000;
      backdrop-filter: blur(10px);
    }

    .loading-overlay.active {
      display: flex;
    }

    .loading-content {
      text-align: center;
      max-width: 500px;
      padding: 20px;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 3px solid #E8F5E9;
      border-top-color: var(--primary);
      border-right-color: var(--primary-light);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 32px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-stages {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-bottom: 32px;
      flex-wrap: wrap;
    }

    .stage {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      opacity: 0.3;
      transition: all 0.5s ease;
    }

    .stage.active {
      opacity: 1;
      transform: scale(1.1);
    }

    .stage.completed {
      opacity: 0.7;
    }

    .stage-icon {
      font-size: 28px;
      filter: grayscale(1);
      transition: all 0.5s ease;
    }

    .stage.active .stage-icon {
      filter: grayscale(0);
      animation: bounce 1s ease-in-out infinite;
    }

    .stage.completed .stage-icon {
      filter: grayscale(0);
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .stage-label {
      font-size: 12px;
      color: var(--text-secondary);
      font-weight: 500;
      white-space: nowrap;
    }

    .stage.active .stage-label {
      color: var(--primary);
    }

    .loading-text {
      font-size: 18px;
      color: var(--text-primary);
      font-weight: 600;
      margin-bottom: 24px;
    }

    .hiking-fact-container {
      background: #F0F7ED;
      border: 1px solid #E8F5E9;
      border-radius: var(--radius);
      padding: 16px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 24px;
      min-height: 60px;
    }

    .fact-icon {
      font-size: 24px;
      flex-shrink: 0;
    }

    .hiking-fact {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.5;
      text-align: left;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 768px) {
      .loading-stages {
        gap: 16px;
      }

      .stage-icon {
        font-size: 24px;
      }

      .stage-label {
        font-size: 11px;
      }

      .hiking-fact {
        font-size: 13px;
      }
    }

    @media (max-width: 480px) {
      .loading-stages {
        gap: 12px;
      }

      .stage {
        flex: 0 0 45%;
      }
    }

    /* Results Container */
    #itinerary-cards {
      margin-top: 40px;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1) 0.3s;
    }

    #itinerary-cards.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* Existing styles from original page */
    .itinerary-day-card {
      position: relative;
      margin-bottom: 40px;
      background: white;
      border-radius: 16px;
      padding: 0;
      box-shadow: 0 4px 20px var(--shadow);
      transition: all 0.3s ease;
      overflow: hidden;
    }

    .itinerary-day-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 30px var(--shadow);
    }

    .day-card-header {
      background: linear-gradient(135deg, #f8fafb 0%, #e8f0e5 100%);
      padding: 25px 30px;
      border-bottom: 1px solid #e5e7eb;
      position: relative;
    }

    .day-number {
      font-size: 0.85em;
      color: var(--primary);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-bottom: 8px;
    }

    .day-title-enhanced {
      font-size: 1.4em;
      margin: 0;
      color: var(--text-dark);
      font-weight: 700;
      line-height: 1.3;
    }

    .day-card-content {
      padding: 35px;
    }

    /* Responsive - EVEN MORE COMPACT */
    @media (max-width: 768px) {
      .hero-enhanced {
        height: 40vh;
        min-height: 300px;
      }
      
      .hero-content-enhanced h1 {
        font-size: 2em;
      }
      
      .hero-content-enhanced h2 {
        font-size: 1.2em;
      }

      .main-content-area {
        margin-top: -40px;
        padding: 0 16px 24px;
      }

      .quiz-content {
        padding: 20px;
      }

      .quiz-header {
        margin-bottom: 16px;
      }

      .question-title {
        font-size: 20px;
      }

      .question-subtitle {
        font-size: 13px;
      }

      .options-grid {
        margin-top: 16px;
        gap: 8px;
      }

      .option-button {
        padding: 14px 16px;
      }

      .option-icon {
        width: 20px;
        height: 20px;
      }

      .two-column-grid {
        grid-template-columns: 1fr;
      }

      .three-column-grid {
        grid-template-columns: 1fr;
      }

      .interests-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
      }

      .interest-button {
        padding: 10px;
      }

      .quiz-navigation {
        margin-top: 20px;
        padding-top: 12px;
      }

      .nav-button {
        padding: 10px 16px;
        font-size: 14px;
      }

      .nav-button.generate {
        padding: 12px 24px;
        font-size: 15px;
      }

      i[data-lucide] {
        width: 20px;
        height: 20px;
      }
    }

    @media (max-width: 480px) {
      .quiz-content {
        padding: 16px;
      }

      .quiz-header {
        margin-bottom: 12px;
      }

      .question-title {
        font-size: 18px;
        line-height: 1.2;
      }

      .options-grid {
        margin-top: 12px;
      }

      .option-button {
        padding: 12px 14px;
      }

      .interests-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .interest-button {
        padding: 8px;
        font-size: 12px;
      }

      .interest-icon {
        width: 20px;
        height: 20px;
      }

      .text-input {
        min-height: 80px;
        font-size: 14px;
      }

      .quiz-navigation {
        margin-top: 16px;
        flex-direction: column;
        gap: 8px;
      }

      .nav-button.back {
        order: 2;
      }

      .nav-button.skip {
        order: 3;
      }

      .nav-button.next,
      .nav-button.generate {
        order: 1;
        width: 100%;
      }
    }

    /* Modal styles from original */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      backdrop-filter: blur(4px);
    }

    .modal {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 24px;
      padding: 40px;
      max-width: 480px;
      width: 90%;
      position: relative;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transform: scale(1);
      animation: modalAppear 0.3s ease-out;
    }

    @keyframes modalAppear {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
  </style>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJDWMQZV"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <!-- Enhanced Hero Header -->
  <header class="hero-enhanced">
    <div class="hero-bg" style="background-image: url('Images/alps.jpg');"></div>
    <div class="hero-content-enhanced">
      <h1>Create Your Perfect Trek</h1>
    </div>
  </header>

  <!-- Main Content Area -->
  <main class="main-content-area">
    <!-- Quiz Container -->
    <div class="quiz-container" id="quizContainer">
      <!-- Progress Bar -->
      <div class="progress-container">
        <div class="progress-bar" id="progressBar" style="width: 0%"></div>
      </div>

      <!-- Quiz Content -->
      <div class="quiz-content">
        <div class="quiz-header">
          <div class="step-indicator" id="stepIndicator">Step 1 of 8</div>
          <h2 class="question-title" id="questionTitle">Let's plan your perfect trek</h2>
          <p class="question-subtitle" id="questionSubtitle">Answer a few questions to get a personalized itinerary</p>
        </div>

        <div class="questions-wrapper">
          <!-- Question 1: Trek Type -->
          <div class="question-slide active" data-question="trek-type">
            <div class="options-grid">
              <button class="option-button" data-value="day-hike">
                <i class="option-icon" data-lucide="clock" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Day Hike</div>
                  <div class="option-description">Return to comfort each evening</div>
                </div>
              </button>
              <button class="option-button" data-value="multi-day">
                <i class="option-icon" data-lucide="tent" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Multi-Day Trek</div>
                  <div class="option-description">Immerse yourself in nature for days</div>
                </div>
              </button>
            </div>
          </div>

          <!-- Question 2: Trek Length (conditional) -->
          <div class="question-slide" data-question="trek-length">
            <div class="options-grid two-column-grid">
              <button class="option-button" data-value="3-5">
                <div class="option-content">
                  <div class="option-title">3-5 days</div>
                  <div class="option-description">Long weekend escape</div>
                </div>
              </button>
              <button class="option-button" data-value="6-8">
                <div class="option-content">
                  <div class="option-title">6-8 days</div>
                  <div class="option-description">Full week adventure</div>
                </div>
              </button>
              <button class="option-button" data-value="9-14">
                <div class="option-content">
                  <div class="option-title">9-14 days</div>
                  <div class="option-description">Extended journey</div>
                </div>
              </button>
              <button class="option-button" data-value="15+">
                <div class="option-content">
                  <div class="option-title">15+ days</div>
                  <div class="option-description">Epic expedition</div>
                </div>
              </button>
            </div>
          </div>

          <!-- Question 3: Location -->
          <div class="question-slide" data-question="location">
            <div class="options-grid three-column-grid">
              <button class="option-button" data-value="any">
                <i class="option-icon" data-lucide="globe" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Anywhere</div>
                </div>
              </button>
              <button class="option-button" data-value="europe">
                <i class="option-icon" data-lucide="mountain" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Europe</div>
                </div>
              </button>
              <button class="option-button" data-value="asia">
                <i class="option-icon" data-lucide="mountain-snow" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Asia</div>
                </div>
              </button>
              <button class="option-button" data-value="americas">
                <i class="option-icon" data-lucide="compass" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Americas</div>
                </div>
              </button>
              <button class="option-button" data-value="oceania">
                <i class="option-icon" data-lucide="map" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Oceania</div>
                </div>
              </button>
              <button class="option-button" data-value="africa">
                <i class="option-icon" data-lucide="palmtree" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Africa</div>
                </div>
              </button>
            </div>
          </div>

          <!-- Question 4: Difficulty -->
          <div class="question-slide" data-question="difficulty">
            <div class="options-grid">
              <button class="option-button" data-value="easy">
                <i class="option-icon" data-lucide="smile" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Easy</div>
                  <div class="option-description">Gentle paths, minimal elevation gain</div>
                </div>
              </button>
              <button class="option-button" data-value="moderate">
                <i class="option-icon" data-lucide="trending-up" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Moderate</div>
                  <div class="option-description">Some challenging sections, good fitness needed</div>
                </div>
              </button>
              <button class="option-button" data-value="challenging">
                <i class="option-icon" data-lucide="zap" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Challenging</div>
                  <div class="option-description">Steep terrain, high altitude, excellent fitness</div>
                </div>
              </button>
            </div>
          </div>

          <!-- Question 5: Accommodation -->
          <div class="question-slide" data-question="accommodation">
            <div class="options-grid two-column-grid">
              <button class="option-button" data-value="camping">
                <i class="option-icon" data-lucide="tent" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Camping</div>
                  <div class="option-description">Under the stars</div>
                </div>
              </button>
              <button class="option-button" data-value="huts">
                <i class="option-icon" data-lucide="home" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Mountain Huts</div>
                  <div class="option-description">Basic shelter</div>
                </div>
              </button>
              <button class="option-button" data-value="lodges">
                <i class="option-icon" data-lucide="bed" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Lodges</div>
                  <div class="option-description">Comfortable stays</div>
                </div>
              </button>
              <button class="option-button" data-value="mixed">
                <i class="option-icon" data-lucide="layers" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Mixed</div>
                  <div class="option-description">Variety of options</div>
                </div>
              </button>
            </div>
          </div>

          <!-- Question 6: Season -->
          <div class="question-slide" data-question="season">
            <div class="options-grid two-column-grid">
              <button class="option-button" data-value="spring">
                <i class="option-icon" data-lucide="flower" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Spring</div>
                  <div class="option-description">Wildflowers & mild weather</div>
                </div>
              </button>
              <button class="option-button" data-value="summer">
                <i class="option-icon" data-lucide="sun" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Summer</div>
                  <div class="option-description">Long days & warm weather</div>
                </div>
              </button>
              <button class="option-button" data-value="autumn">
                <i class="option-icon" data-lucide="leaf" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Autumn</div>
                  <div class="option-description">Fall colors & crisp air</div>
                </div>
              </button>
              <button class="option-button" data-value="winter">
                <i class="option-icon" data-lucide="snowflake" size="24"></i>
                <div class="option-content">
                  <div class="option-title">Winter</div>
                  <div class="option-description">Snow-covered landscapes</div>
                </div>
              </button>
            </div>
          </div>

          <!-- Question 7: Interests (Multi-select) -->
          <div class="question-slide" data-question="interests">
            <div class="interests-grid">
              <button class="interest-button" data-value="wildlife">
                <i class="interest-icon" data-lucide="binoculars" size="24"></i>
                <span class="interest-label">Wildlife</span>
              </button>
              <button class="interest-button" data-value="photography">
                <i class="interest-icon" data-lucide="camera" size="24"></i>
                <span class="interest-label">Photography</span>
              </button>
              <button class="interest-button" data-value="culture">
                <i class="interest-icon" data-lucide="landmark" size="24"></i>
                <span class="interest-label">Culture</span>
              </button>
              <button class="interest-button" data-value="solitude">
                <i class="interest-icon" data-lucide="user" size="24"></i>
                <span class="interest-label">Solitude</span>
              </button>
              <button class="interest-button" data-value="peaks">
                <i class="interest-icon" data-lucide="triangle" size="24"></i>
                <span class="interest-label">Peak Bagging</span>
              </button>
              <button class="interest-button" data-value="lakes">
                <i class="interest-icon" data-lucide="waves" size="24"></i>
                <span class="interest-label">Lakes & Rivers</span>
              </button>
              <button class="interest-button" data-value="forests">
                <i class="interest-icon" data-lucide="trees" size="24"></i>
                <span class="interest-label">Forests</span>
              </button>
              <button class="interest-button" data-value="glaciers">
                <i class="interest-icon" data-lucide="mountain-snow" size="24"></i>
                <span class="interest-label">Glaciers</span>
              </button>
            </div>
          </div>

          <!-- Question 8: Additional Details -->
          <div class="question-slide" data-question="details">
            <div class="text-input-wrapper">
              <textarea 
                class="text-input" 
                id="additionalDetails"
                placeholder="Tell us more about your dream trek... Any specific requirements, dietary needs, group size, budget considerations, or must-see places?"
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <div class="quiz-navigation">
          <button class="nav-button back" id="backBtn" onclick="previousQuestion()" style="visibility: hidden;">
            <i data-lucide="arrow-left" size="20"></i>
            Back
          </button>
          <button class="nav-button skip" id="skipBtn" onclick="skipQuestion()">
            Skip this question
          </button>
          <button class="nav-button next" id="nextBtn" onclick="nextQuestion()">
            Next
            <i data-lucide="arrow-right" size="20"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Loading Overlay (moved outside quiz container) -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        
        <div class="loading-stages">
          <div class="stage active" data-stage="1">
            <div class="stage-icon">üó∫Ô∏è</div>
            <div class="stage-label">Analyzing preferences</div>
          </div>
          <div class="stage" data-stage="2">
            <div class="stage-icon">üèîÔ∏è</div>
            <div class="stage-label">Finding perfect trails</div>
          </div>
          <div class="stage" data-stage="3">
            <div class="stage-icon">üèïÔ∏è</div>
            <div class="stage-label">Planning accommodations</div>
          </div>
          <div class="stage" data-stage="4">
            <div class="stage-icon">‚ú®</div>
            <div class="stage-label">Crafting your itinerary</div>
          </div>
        </div>
        
        <div class="loading-text">Creating your perfect trek...</div>
        
        <div class="hiking-fact-container">
          <div class="fact-icon">üí°</div>
          <div class="hiking-fact" id="hikingFact">Did you know? The Appalachian Trail spans 2,190 miles across 14 states!</div>
        </div>
      </div>
    </div>

    <!-- Results Container -->
    <div id="itinerary-cards"></div>
  </main>

  <!-- Success Modal -->
  <div class="modal-overlay" id="itinerary-success-modal" style="display: none;">
    <!-- Modal content... (keeping existing modal code) -->
  </div>

  <!-- Authentication Required Modal -->
  <div class="modal-overlay" id="auth-required-modal" style="display: none;">
    <!-- Modal content... (keeping existing modal code) -->
  </div>

  <!-- Welcome Back Modal -->
  <div class="modal-overlay" id="welcome-back-modal" style="display: none;">
    <!-- Modal content... (keeping existing modal code) -->
  </div>

  <!-- Footer Container -->
  <div id="footer-container"></div>

  <!-- Scripts -->
  <script src="js/utils/itinerary.js" type="module"></script>
  <script src="js/pages/customize.js" type="module"></script>
  <script src="js/components/navbar.js" type="module"></script>
  <script src="js/components/footer.js" type="module"></script>
  
  <!-- Quiz Script -->
  <script>
    // Initialize Lucide icons
    lucide.createIcons();

    // Quiz state
    let currentQuestion = 0;
    const totalQuestions = 8;
    let answers = {};
    let questionFlow = ['trek-type', 'location', 'difficulty', 'accommodation', 'season', 'interests', 'details'];

    // Question configurations
    const questionConfigs = {
      'trek-type': {
        title: "What type of adventure are you planning?",
        subtitle: "Choose your preferred trek style"
      },
      'trek-length': {
        title: "How many days will you be trekking?",
        subtitle: "Select your ideal duration"
      },
      'location': {
        title: "Where would you like to explore?",
        subtitle: "Choose a region or let us surprise you"
      },
      'difficulty': {
        title: "What's your fitness level?",
        subtitle: "We'll match trails to your ability"
      },
      'accommodation': {
        title: "Where do you want to sleep?",
        subtitle: "Choose your preferred accommodation style"
      },
      'season': {
        title: "When are you planning to go?",
        subtitle: "Different seasons offer unique experiences"
      },
      'interests': {
        title: "What excites you most?",
        subtitle: "Select all that apply"
      },
      'details': {
        title: "Anything else we should know?",
        subtitle: "Add any special requirements or preferences"
      }
    };

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updateProgress();
      setupEventListeners();
    });

    function setupEventListeners() {
      // Single select options
      document.querySelectorAll('.option-button').forEach(button => {
        button.addEventListener('click', function() {
          const slide = this.closest('.question-slide');
          slide.querySelectorAll('.option-button').forEach(btn => btn.classList.remove('selected'));
          this.classList.add('selected');
          
          const question = slide.dataset.question;
          answers[question] = this.dataset.value;
          
          // Auto-advance for single select
          setTimeout(() => nextQuestion(), 300);
        });
      });

      // Multi-select interests
      document.querySelectorAll('.interest-button').forEach(button => {
        button.addEventListener('click', function() {
          this.classList.toggle('selected');
          updateInterestsAnswer();
        });
      });

      // Text input
      document.getElementById('additionalDetails').addEventListener('input', function() {
        answers['details'] = this.value;
      });
    }

    function updateInterestsAnswer() {
      const selected = Array.from(document.querySelectorAll('.interest-button.selected'))
        .map(btn => btn.dataset.value);
      answers['interests'] = selected;
    }

    function updateQuestionFlow() {
      // Adjust question flow based on trek type
      if (answers['trek-type'] === 'day-hike') {
        // Remove trek-length and accommodation questions for day hikes
        questionFlow = ['trek-type', 'location', 'difficulty', 'season', 'interests', 'details'];
      } else {
        // Include trek-length for multi-day treks
        questionFlow = ['trek-type', 'trek-length', 'location', 'difficulty', 'accommodation', 'season', 'interests', 'details'];
      }
    }

    function nextQuestion() {
      if (currentQuestion === 0) {
        updateQuestionFlow();
      }

      if (currentQuestion < questionFlow.length - 1) {
        currentQuestion++;
        showQuestion(currentQuestion);
      } else {
        generateItinerary();
      }
    }

    function previousQuestion() {
      if (currentQuestion > 0) {
        currentQuestion--;
        showQuestion(currentQuestion);
      }
    }

    function skipQuestion() {
      const currentQuestionName = questionFlow[currentQuestion];
      answers[currentQuestionName] = 'skipped';
      nextQuestion();
    }

    function showQuestion(index) {
      // Update all slides
      document.querySelectorAll('.question-slide').forEach(slide => {
        slide.classList.remove('active');
      });

      const currentQuestionName = questionFlow[index];
      const currentSlide = document.querySelector(`[data-question="${currentQuestionName}"]`);
      
      if (currentSlide) {
        currentSlide.classList.add('active');
        
        // Update header
        const config = questionConfigs[currentQuestionName];
        document.getElementById('questionTitle').textContent = config.title;
        document.getElementById('questionSubtitle').textContent = config.subtitle;
      }

      // Update navigation
      document.getElementById('backBtn').style.visibility = index === 0 ? 'hidden' : 'visible';
      document.getElementById('skipBtn').style.display = index === questionFlow.length - 1 ? 'none' : 'block';
      
      const isLastQuestion = index === questionFlow.length - 1;
      const nextBtn = document.getElementById('nextBtn');
      
      if (isLastQuestion) {
        nextBtn.innerHTML = '<i data-lucide="sparkles" size="20"></i> Generate Itinerary';
        nextBtn.classList.add('generate');
      } else {
        nextBtn.innerHTML = 'Next <i data-lucide="arrow-right" size="20"></i>';
        nextBtn.classList.remove('generate');
      }

      updateProgress();
      updateStepIndicator();
      
      // Re-initialize Lucide icons for dynamically added content
      lucide.createIcons();
    }

    function updateProgress() {
      const progress = ((currentQuestion + 1) / questionFlow.length) * 100;
      document.getElementById('progressBar').style.width = `${progress}%`;
    }

    function updateStepIndicator() {
      document.getElementById('stepIndicator').textContent = `Step ${currentQuestion + 1} of ${questionFlow.length}`;
    }

    async function generateItinerary() {
      // Show loading overlay
      document.getElementById('loadingOverlay').classList.add('active');
      
      // Initialize loading stages
      startLoadingAnimation();

      // Prepare the data
      const formData = {
        trekType: answers['trek-type'] || 'multi-day',
        trekLength: answers['trek-length'] || '6-8',
        location: answers['location'] || 'any',
        difficulty: answers['difficulty'] || 'moderate',
        accommodation: answers['accommodation'] || 'mixed',
        season: answers['season'] || 'summer',
        interests: answers['interests'] || [],
        details: answers['details'] || ''
      };

      // Create a comprehensive prompt
      let prompt = `Generate a ${formData.trekType === 'day-hike' ? 'day hike' : `${formData.trekLength} day trek`} itinerary with the following preferences:\n`;
      prompt += `- Location: ${formData.location}\n`;
      prompt += `- Difficulty: ${formData.difficulty}\n`;
      prompt += `- Season: ${formData.season}\n`;
      
      if (formData.trekType === 'multi-day') {
        prompt += `- Accommodation: ${formData.accommodation}\n`;
      }
      
      if (formData.interests.length > 0) {
        prompt += `- Interests: ${formData.interests.join(', ')}\n`;
      }
      
      if (formData.details) {
        prompt += `- Additional requirements: ${formData.details}\n`;
      }

      // Fade out quiz with elegant animation
      setTimeout(() => {
        const quizContainer = document.getElementById('quizContainer');
        quizContainer.classList.add('fade-out');
        
        setTimeout(() => {
          quizContainer.style.display = 'none';
          
          // In production, this would call your API
          // For now, we'll simulate the API response
          setTimeout(() => {
            // Stop loading animation
            stopLoadingAnimation();
            
            // Hide loading overlay
            document.getElementById('loadingOverlay').classList.remove('active');
            
            // Show results container
            const resultsContainer = document.getElementById('itinerary-cards');
            resultsContainer.classList.add('show');
            
            // Here you would normally display the generated itinerary
            resultsContainer.innerHTML = `
              <div class="itinerary-day-card">
                <div class="day-card-header">
                  <div class="day-number">Your Custom Itinerary</div>
                  <h3 class="day-title-enhanced">Trek Generated Successfully!</h3>
                </div>
                <div class="day-card-content">
                  <p style="color: var(--text-dark); line-height: 1.8;">
                    In production, this would display your AI-generated itinerary based on:<br><br>
                    <strong>Trek Type:</strong> ${formData.trekType}<br>
                    <strong>Duration:</strong> ${formData.trekLength || 'Day hike'}<br>
                    <strong>Location:</strong> ${formData.location}<br>
                    <strong>Difficulty:</strong> ${formData.difficulty}<br>
                    <strong>Season:</strong> ${formData.season}<br>
                    ${formData.accommodation ? `<strong>Accommodation:</strong> ${formData.accommodation}<br>` : ''}
                    ${formData.interests.length > 0 ? `<strong>Interests:</strong> ${formData.interests.join(', ')}<br>` : ''}
                    ${formData.details ? `<strong>Special Requirements:</strong> ${formData.details}` : ''}
                  </p>
                </div>
              </div>
            `;
          }, 12000); // Simulate 12 second loading time
        }, 500);
      }, 300);

      console.log('Generated prompt:', prompt);
      console.log('Form data:', formData);
    }

    // Loading animation functions
    let loadingInterval;
    let factInterval;
    let stageInterval;
    let currentStage = 1;

    const hikingFacts = [
      "Did you know? The Appalachian Trail spans 2,190 miles across 14 states!",
      "Fun fact: Mount Everest grows about 4 millimeters each year due to geological forces.",
      "Hiking tip: The 'Leave No Trace' principles help preserve trails for future generations.",
      "Did you know? The Inca Trail to Machu Picchu limits visitors to 500 per day to protect the path.",
      "Trail wisdom: 'Cotton kills' - synthetic fabrics dry faster and keep you warmer when wet.",
      "Fun fact: The Pacific Crest Trail crosses through 7 national parks and 25 national forests.",
      "Did you know? Norway's 'allemannsretten' law gives everyone the right to roam freely in nature.",
      "Hiking burns about 400-700 calories per hour depending on terrain and pack weight.",
      "The longest hiking trail in the world is Canada's Trans Canada Trail at 24,000 km!",
      "Did you know? Studies show that hiking can increase creative problem-solving by 50%.",
      "Fun fact: The Swiss have over 65,000 km of marked hiking trails - that's 1.5x Earth's circumference!",
      "Trail tip: Trekking poles can reduce stress on knees by up to 25% on descents."
    ];

    function startLoadingAnimation() {
      currentStage = 1;
      
      // Update stages every 3 seconds
      stageInterval = setInterval(() => {
        // Mark current stage as completed
        document.querySelector(`.stage[data-stage="${currentStage}"]`).classList.remove('active');
        document.querySelector(`.stage[data-stage="${currentStage}"]`).classList.add('completed');
        
        // Move to next stage
        currentStage++;
        if (currentStage <= 4) {
          document.querySelector(`.stage[data-stage="${currentStage}"]`).classList.add('active');
        }
      }, 3000);
      
      // Rotate facts every 4 seconds
      let factIndex = 0;
      factInterval = setInterval(() => {
        factIndex = (factIndex + 1) % hikingFacts.length;
        const factElement = document.getElementById('hikingFact');
        factElement.style.animation = 'none';
        setTimeout(() => {
          factElement.textContent = hikingFacts[factIndex];
          factElement.style.animation = 'fadeIn 0.5s ease';
        }, 10);
      }, 4000);
    }

    function stopLoadingAnimation() {
      clearInterval(stageInterval);
      clearInterval(factInterval);
      
      // Reset stages
      document.querySelectorAll('.stage').forEach(stage => {
        stage.classList.remove('active', 'completed');
      });
      document.querySelector('.stage[data-stage="1"]').classList.add('active');
    }
  </script>
</body>
</html>